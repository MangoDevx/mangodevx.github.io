---
import Layout from '../layouts/Layout.astro';
import SplashScreen from '../components/SplashScreen.astro';
---

<Layout title="Welcome - Keith Ritter">

  <!-- Splash Screen Container -->
  <div 
    id="splash-container" 
    class="fixed inset-0 z-50 bg-black"
  >
    <SplashScreen />
  </div>
</Layout>

<script>
import { navigate } from "astro:transitions/client";
import type SplashScreenLoader from '../components/SplashScreenLoader';

let splashLoader: SplashScreenLoader | null = null;

// Listen for the splash screen completion event
document.addEventListener('splashScreenComplete', () => {
  navigate('/home');
});

// Get reference to the splash loader instance
document.addEventListener('astro:load', () => {
  import('../components/SplashScreenLoader.js').then((module) => {
    const threejsCanvas = document.getElementById('threejs-canvas');
    if (threejsCanvas) {
      splashLoader = new module.default('threejs-canvas');
    }
  });
});

// Clean up resources before transitioning
document.addEventListener('astro:before-swap', () => {
  if (splashLoader) {
    splashLoader.cleanup();
  }
});
</script>

<style>
  #splash-container {
    transition: opacity 1s ease-out;
  }
</style>